import pandas as pd
import glob
import os
import time

start_time=time.perf_counter()

# Folder containing your Excel files
input_folder = r"C:\Users\Joseph Nguyen\Python Testing\Data"
output_folder = r"C:\Users\Joseph Nguyen\Python Testing\Data\CSVs"

# Make sure output folder exists
os.makedirs(output_folder, exist_ok=True)

# Get all Excel files
excel_files = glob.glob(os.path.join(input_folder, "*.xlsx"))

cols=['Time (s)',
      'A4 12KV BUS SEC A GFN 1 ZERO SEQ VOLTAGE (3V0) Vn',
      'A8 12KV BUS SEC C GFN 2 ZERO SEQ VOLTAGE (3V0) Vn',
      'A59 DEALER 12KV GFN ZERO SEQ AMPS 500:5 FULL SCALE: 3 In',
      'A63 LOTTO 12KV GFN ZERO SEQ AMPS 500:5 FULL SCALE: 3 In',
      'A64 KENO 12KV GFN ZERO SEQ AMPS 500:5 FULL SCALE: 3 In',
      'A68 GAMBLER 12KV GFN ZERO SEQ AMPS 500:5 FULL SCALE: 3 In' ]

for file in excel_files:
    df = pd.read_excel(file,usecols=cols)  # read the Excel file
    # create a CSV file with the same name
    csv_file = os.path.join(output_folder, os.path.basename(file).replace(".xlsx", ".csv"))
    df.to_csv(csv_file, index=False)  # save as CSV without row numbers
    base_name = os.path.splitext(os.path.basename(file))[0]
    end_time=time.perf_counter()
    elapsed_time=end_time-start_time
    print(f"File: {base_name} Time: {elapsed_time:.2f}")


end_time=time.perf_counter()
elapsed_time=end_time-start_time
print(f"\nScript Completed in {elapsed_time:.2f} seconds.")

 
